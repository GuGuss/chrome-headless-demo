function isCustomerMemberWithinXDays(e,t){if(t=t||90,""!=e){var o=new Date(e),n=new Date,i=n.getTime()-o.getTime(),a=Math.floor(i/864e5);return a<t}}function atLeastOneSKUSelected(e){return e=e||0,parseInt(e)>0}function isDefined(e){return!!e&&e.length>0}function safeStringify(e){var t="";try{t=JSON.stringify(e)}catch(o){}return t}var mmx=mmx||{},_cookieObj={};mmx.custom={isNewHeaderFooter:function(){return!0},getCustomerType:function(){var e=mmx.Cookies.getCookie("SMSESSION"),t=mmx.Cookies.getCookie("dcsso"),o=e||t;return o&&o.length>0&&"LOGGEDOFF"!==o?"CUSTOMER":o&&o.length>0&&"LOGGEDOFF"==o?"KNOWN_CUSTOMER":"GUEST"},init:function(){window.newHeaderFooter=this.isNewHeaderFooter(),custType=this.getCustomerType(),setUserInfo()}},mmx.Cookies={getCookie:function(e){return _cookieObj[e]},getCookies:function(){return _cookieObj},deleteCookie:function(e,t){},setCookie:function(e,t,o){_cookieObj[e]=t;var n=new Date;n.setTime(n.getTime()),o&&(o=1e3*o*60*60*24);var i=new Date(n.getTime()+o);document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+(o?";expires="+i.toUTCString():"")+"; path=/"},updateCookies:function(){},init:function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var o=e[t].split("=");if(o&&o.length>1){var n=o[0].replace(" ","");if("expires"===n)continue;_cookieObj[n]=decodeURIComponent(o[1])}}}};var isValidCISData=function(e){if(e){var t=e.setTime,o=36e5,n=new Date-new Date(t)>o;return!n}return!1},updateUserInfo=function(){var e=window.location.host,t=e.indexOf("staples.com")>-1;if(localStorage&&t){var o=JSON.parse(localStorage.getItem("cisInfo")),n=!1;"undefined"!=typeof localStorage&&localStorage.userStatus&&localStorage.userStatus!==custType&&(n=!0),n?setSegDetails():isValidCISData(o)?(updateAnalyticsDLO(),updateMyAccountLinks(),localStorage.setItem("userStatus",custType)):setSegDetails()}},setUserInfo=function(){var e=setInterval(function(){"undefined"!=typeof mmx&&mmx.Cookies&&(mmx.Cookies.getCookie("kyd-fp-v1")||localStorage["kyd-fp-v1"])&&(clearInterval(e),updateUserInfo())},500)},setSegDetails=function(){$.ajax({url:"/asgard-node/v1/nad/staplesus/cusgt",timeout:1e3,success:function(e){var t=new Date,o={cisData:e,setTime:t};localStorage.setItem("cisInfo",JSON.stringify(o)),updateMyAccountLinks(),updateAnalyticsDLO(),localStorage.setItem("userStatus",custType)}})},updateMyAccountLinks=function(){var e=["5_BEP_BSE","6_BEP_BSE","7_BEP_PMR","8_BEP_PMR","9_BEP","10_BEP"],t=["11_FREE_BRP_PR6","12_FREE_BRP_PR6","13_FREE_BRP_PR6","14_FREE_BRP_PR6","15_PAID_BRP_PR7","16_PAID_BRP_PR7","17_PAID_BRP_PR7","18_PAID_BRP_PR7"],o=JSON.parse(localStorage.getItem("cisInfo")),n=o?o.cisData:{},i=n.segmentID;e.indexOf(i)>-1?($(".BEP").removeClass("dont-show"),$(".BEP").show(),$(".BRP").remove()):t.indexOf(i)>-1?($(".BRP").removeClass("dont-show"),$(".BEP").remove(),$(".membership-default").remove(),$(".membership-BRP, .BRP").show()):($(".business-excl-mem,.business-rew-plus-mem, .account-nav-item .staples-plus-mem, .BEP, .BRP, .membership-BRP").remove(),"19_PB"!==i&&"20_SAA"!==i||($(".deals-default").remove(),$(".deals-19_20_segments").removeClass("dont-show"))),updateAccountText(i),updateClientID(i,n)},updateAccountText=function(e){if("undefined"!=typeof e&&"1_UNIDENTIFIED"!==e){$("#section-account .section-icon-label").hide(),$("#account-text").show();var t=$("#account-text").text();$("#section-account").attr("title",t)}else if(mmx&&mmx.custom&&"CUSTOMER"==mmx.custom.getCustomerType()){$("#section-account .section-icon-label").hide(),$("#account-text").show();var t=$("#account-text").text();$("#section-account").attr("title",t)}},updateClientID=function(e,t){if("undefined"!=typeof e&&"1_UNIDENTIFIED"!==e){var o="undefined"!=typeof t&&t.orchidData&&t.orchidData.staplesId?t.orchidData.staplesId:null;if(o){var n=o.substring(o.length-4,o.length);clientIDText=$(".client-id").html()+n,$(".client-id").html(clientIDText),$(".client-id").show()}}},updateAnalyticsDLO=function(){var e=window.Analytics||{};e.global=e.global||{},e.global.visitor=e.global.visitor||{},e.global.visitor.kyd=e.global.visitor.kyd||{};var t={},o=JSON.parse(localStorage.getItem("cisInfo")),n=o?o.cisData:{},i=n.orchidData,a=n.membershipData;i&&(t.customersegmentID=n.segmentID||"",t.customersegment=n.orchidData.tierSegment||"",t.rewardsno=safeStringify(n.orchidData.rewardsNo)||"",t.rewardstier=n.orchidData.rewardsTierCd||"",t.dcn=n.orchidData.customerNo||"",t.customertype=n.orchidData.businessConsumerFlag||"",t.dcnstatus=isDefined(n.orchidData.customerNo)||"",t.zoneid=n.orchidData.zoneId||"",t.suffixcode=safeStringify(n.orchidData.suffixCodes)||"",t.industryvertical=n.orchidData.industryVertical||"",t.companysize=n.orchidData.companySize||"",t.companysizecode=n.orchidData.companySizeCode||"",t.companysizedesc=n.orchidData.companySizeDesc||"",t.crosschannel=n.orchidData.crossChannel||""),a&&(t.newcustomer=isCustomerMemberWithinXDays(n.membershipData.memberSinceDate,90)||"",t.programskucount=n.membershipData.skuCount||"",t.programskuselection=atLeastOneSKUSelected(n.membershipData.skuCount),t.expirationDate=n.membershipData.expirationDate||""),Object.keys(n).length>0&&(t.CISResponse=n||""),e.global.visitor.kyd=t,window.Analytics=e};$(document).ready(function(){window.newHeaderFooter=!0,mmx.Cookies.init(),mmx.custom.init()});var mmx=mmx||{},resizeTimeout,tophatHeight=0,mmxHeaderHeight=0;mmx.dropdown={props:{dropdown:".mmx-hf.mmx-header .mmx-dropdown",sectionDropdowns:".mmx-hf.mmx-header .section-dropdowns",sectionDropdown:".mmx-hf.mmx-header .section-dropdown",sectionActiveDropdown:".mmx-hf.mmx-header .section-dropdown.active",sectionDropdownContent:".mmx-hf.mmx-header  .section-dropdown-content",sectionActiveDropdownContent:".mmx-hf.mmx-header  .section-dropdown-content.active",activeDropdown:".mmx-hf.mmx-header .mmx-dropdown.active",flyoutArea:".mmx-hf.mmx-header .mmx-flyout",activeContent:".mmx-hf.mmx-header .mmx-dropdown-content.active",dropContent:".mmx-hf.mmx-header .mmx-dropdown-content",close:".mmx-hf.mmx-header .flyout-close",flyoutParent:".mmx-hf.mmx-header .flyout-menu-list",flyoutListItems:".mmx-hf.mmx-header .flyout-list-item",blur:".mmx-elements-container .header-blur-background",cartItemsBadge:".mmx-hf.mmx-header .mmx-dropdown #STP--Cart-NumberItems",cartItemsInFlyout:".mmx-hf.mmx-header #section-cart-content.mmx-dropdown-content #STP--Cart-Count",promoAdBanner:".mmx-hf.mmx-header .flyout-ad"},ui:function(){function e(e,t){if(e)for(var o=$(e.parentNode);!$(o).hasClass("mmx-header");){if($(o).hasClass("mmx-dropdown-content")&&$(o).attr("id")==t)return!0;if(!o)return!1;o=$(o)[0].parentNode}return!1}function t(e){$(e.props.activeContent).removeClass("active"),$(e.props.activeDropdown).removeClass("active"),e.removeMask()}function o(e){for(var t=e.find("[data-src]"),o=t.length,n=0;n<o;n++){var i=t[n];$(i).attr("src",$(i).data("src")),n===o-1&&e.data("loadassets",!1)}}function n(e){var t=e.data("loadassets");t&&o(e)}var i,a,r=this,s=function(e){"click"===e.type&&mmx.search.searchClose(),e.stopPropagation();var t,o,i,a=$(this);if("mouseenter"!==e.type&&"mouseleave"!==e.type||isTouchDevice()?(t=$(r.props.activeDropdown),o=$(r.props.activeContent),i=!0):(t=$(r.props.sectionActiveDropdown),o=$(r.props.sectionActiveDropdownContent),i=!1),a.hasClass("active"))t.removeClass("active"),r.removeMask();else{t.removeClass("active"),a.addClass("active"),a.hasClass("mmx-flyout")||r.showMask();var s=a.hasClass("mmx-flyout");i&&s&&r.removeMask()}var m,c=$("#"+$(this).attr("id")+"-content");if(o.not(c).removeClass("active"),c.toggleClass("active"),c.has(r.props.flyoutParent)&&(m=c.find(r.props.flyoutListItems),$(m).removeClass("active"),$(m).first().trigger("mouseover")),$(this).hasClass("category-dropdown")&&($(this).hasClass("active")?(n(c),$(mmx.dropdown.props.activeContent+" .flyout-list-item").removeClass("active"),$(mmx.dropdown.props.activeContent+" .flyout-list-item").first().addClass("active"),$(mmx.dropdown.props.activeContent+" .flyout-content-item").removeClass("active"),$(mmx.dropdown.props.activeContent+" .flyout-content-item").first().addClass("active"),r.showMask()):r.removeMask()),$(this).hasClass("cart")){var d=$(r.props.cartItemsBadge).text().toLowerCase();""!==d&&$(r.props.cartItemsInFlyout).text(d)}};!isTouchDevice()&&$(r.props.flyoutArea).on("mouseenter",s),!isTouchDevice()&&$(r.props.flyoutArea).on("mouseleave",function(t){i=t.clientX,a=t.clientY;var o=document.elementFromPoint(i,a),n=$(t.currentTarget).attr("id")+"-content";$(o).hasClass("mmx-dropdown-content")||e($(o)[0],n)||($(r.props.flyoutArea).removeClass("active"),$(r.props.sectionDropdownContent).removeClass("active"))}),$(r.props.sectionDropdowns).on("mouseleave",function(e){$(r.props.flyoutArea).removeClass("active"),$(r.props.sectionDropdownContent).removeClass("active")}),$(r.props.dropdown).on("click",s),$(r.props.dropContent).on("click",function(e){e.stopPropagation(),$(this).addClass("active")}),$(r.props.close).on("click",function(e){e.stopPropagation(),t(r),r.removeMask()}),$(document).on("click",function(e){t(r),r.removeMask()}),togglePromoBanner()},init:function(){var e=this;e.ui()},showMask:function(){var e=$(document).height()-(tophatHeight+mmxHeaderHeight);$(".mmx-elements-container .header-blur-background").css("height",e),$(".mmx-elements-container .header-blur-background").addClass("active")},removeMask:function(){$(".mmx-elements-container .header-blur-background").removeClass("active")}};var isTouchDevice=function(){return window&&window.navigator&&window.navigator.userAgent&&(/Mobi/i.test(window.navigator.userAgent)||/Android/i.test(window.navigator.userAgent))},ispromoAdVisible=function(){$(".mmx-tophat-container").length>0&&(tophatHeight=$(".mmx-tophat-container").height()),mmxHeaderHeight=$(".mmx-hf.mmx-header.mmx-container").height();var e=$(".flyout-menu.flyout-container").height(),t=$(".flyout-ad").length>0?$(".flyout-ad").height():0,o=window.innerHeight,n=tophatHeight+mmxHeaderHeight+e+t;return o>n},togglePromoBanner=function(){ispromoAdVisible()?$(mmx.dropdown.props.promoAdBanner).show():$(mmx.dropdown.props.promoAdBanner).hide()};$(document).ready(function(){mmx.dropdown.init()}),window.onresize=function(){"undefined"!=typeof resizeTimeout&&clearTimeout(resizeTimeout),resizeTimeout=setTimeout(function(){togglePromoBanner(),"undefined"!=typeof FooterService&&FooterService.resetSubMenu()},50)};var mmx=mmx||{};mmx.flyout={props:{mmxmenuItem:".mmx-hf.mmx-header .flyout-list-item",mmxmenuContent:".mmx-hf.mmx-header .flyout-content-item",flyoutParentUl:".mmx-hf.mmx-header .flyout-menu-list ul",menuItem:".flyout-list-item",menuContent:".flyout-content-item"},ui:function(){function e(e){var t=$(e),n=($(e).find(".item-title"),t.attr("id")),i=$("#"+n+"-content");o.outerHeight(),o.outerWidth();i.siblings().removeClass("active"),i.addClass("active"),t.siblings().removeClass("active"),t.addClass("active")}function t(e){var t=$(e),o=($(e).find(".item-title"),t.attr("id")),n=$("#"+o+"-content");$(o).siblings(mmx.flyout.props.mmxmenuItem).removeClass("active"),n.removeClass("active"),t.removeClass("active")}var o=$(".mmx-hf.mmx-header .flyout-menu-list ul");o.menuAim({activate:e,deactivate:t})},init:function(){var e=this;e.ui()}},$(document).ready(function(){mmx.flyout.init()});var mmx=mmx||{};mmx.on=function(e,t){return $(document).on(e,t),this},mmx.off=function(e){return $(document).off(e),this},mmx.trigger=function(e,t){$(document).trigger(e,t)},mmx.events={bodyClick:"bodyClick",windowScrollUp:"windowScrollUp",windowScrollDown:"windowScrollDown",windowScrollTop:"windowScrollTop",windowScrollDownFromTop:"windowScrollDownFromTop"},mmx.global={scrollTop:0,viewport:0,previousBrowserWidth:0,increment:10,props:{header:"mmx-header",footer:"mmx-footer",container:"mmx-container"},init:function(){var e=this;e.setupEvents()},setupEvents:function(){var e=this;e.setupScrollListener(),e.setupBodyClick()},setupScrollListener:function(){var e=this;$(window).scroll(function(t){var o=$(this).scrollTop();if(Math.abs(o-e.scrollTop)<e.increment)return!1})},setupBodyClick:function(){$("body").on("click",function(e){mmx.trigger(mmx.events.bodyClick,this)})}},$(document).ready(function(){mmx.global.init()}),function(e){function t(t){var o=e(this),n=null,i=[],a=null,r=null,s=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t),m=3,c=300,d=function(e){i.push({x:e.pageX,y:e.pageY}),i.length>m&&i.shift()},l=function(){r&&clearTimeout(r),s.exitMenu(this)&&(n&&s.deactivate(n),n=null)},u=function(){r&&clearTimeout(r),s.enter(this),v(this)},p=function(){s.exit(this)},h=function(){f(this)},f=function(e){e!=n&&(n&&s.deactivate(n),s.activate(e),n=e)},v=function g(e){var t=x();t?r=setTimeout(function(){g(e)},t):f(e)},x=function(){function t(e,t){return(t.y-e.y)/(t.x-e.x)}if(!n||!e(n).is(s.submenuSelector))return 0;var r=o.offset(),m={x:r.left,y:r.top-s.tolerance},d={x:r.left+o.outerWidth(),y:m.y},l={x:r.left,y:r.top+o.outerHeight()+s.tolerance},u={x:r.left+o.outerWidth(),y:l.y},p=i[i.length-1],h=i[0];if(!p)return 0;if(h||(h=p),h.x<r.left||h.x>u.x||h.y<r.top||h.y>u.y)return 0;if(a&&p.x==a.x&&p.y==a.y)return 0;var f=d,v=u;"left"==s.submenuDirection?(f=l,v=m):"below"==s.submenuDirection?(f=u,v=l):"above"==s.submenuDirection&&(f=m,v=d);var x=t(p,f),g=t(p,v),w=t(h,f),C=t(h,v);return x<w&&g>C?(a=p,c):(a=null,0)};o.mouseleave(l).find(s.rowSelector).mouseenter(u).mouseleave(p).click(h),e(document).mousemove(d)}e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this}}(jQuery);var mmx=mmx||{};mmx.rating={props:{rating:".mmx-rating",hasRatings:":has(.mmx-icon-rating-full-star, .mmx-icon-rating-half-star, .mmx-icon-rating-empty-star)"},init:function(){var e=this,t=$(e.props.rating).not(e.props.hasRatings);t.each(function(){for(var e=$(this).data("rating"),t=Math.floor(e),o=e-t>0?1:0,n=5-o-t,i=0;i<t;i++)$(this).append('<div class="mmx-icon-rating-full-star"></div>');o&&$(this).append('<div class="mmx-icon-rating-half-star">\n              <div class="mmx-icon-rating-full"></div>\n              <div class="mmx-icon-rating-half"></div>\n            </div>');for(var a=0;a<n;a++)$(this).append('<div class="mmx-icon-rating-empty-star"></div>')})}},$(document).ready(function(){mmx.rating.init()});var mmx=mmx||{};mmx.search={props:{searchContainer:".mmx-hf.mmx-header .search-mmx-container",searchDropdown:".mmx-hf.mmx-header .search-dropdown-container",searchClose:".mmx-hf.mmx-header .search-dropdown-close",middleContainer:".mmx-hf.mmx-header .header-middle",blur:".mmx-elements-container .header-blur-background"},ui:function(){var e=this;$(e.props.searchContainer).on("click",function(t){$(mmx.dropdown.props.close).trigger("click"),t.stopPropagation(),e.searchOpen()}),$(e.props.searchClose).on("click",function(t){t.stopPropagation(),e.searchClose()}),$(e.props.searchDropdown).find("a").on("click",function(t){t.stopPropagation(),e.searchClose()}),$(document).on("click",function(t){var o=$(e.props.searchContainer).hasClass("active");if(o){t?t.target:window.event.srcElement;0===$(t.target).closest(".search-dropdown-content-holder").length&&"search-products-txt-box"!==t.target.id&&"search-clear"!==t.target.classList[0]&&"Close"!==t.target.text&&(t.stopPropagation(),e.searchClose(),$(".search-close a").css("visibility","hidden"),$(".search-form input").val(""),$(".search-clear").hide())}})},fetchAssests:function(e){for(var t=e.find("[data-src]"),o=t.length,n=0;n<o;n++){var i=t[n];$(i).attr("src",$(i).data("src")),n===o-1&&e.data("loadassets",!1)}},lazyLoadAssets:function(e){var t=this,o=e.data("loadassets");o&&t.fetchAssests(e)},searchClose:function(){var e=this;$(e.props.searchContainer).removeClass("active"),$(e.props.middleContainer).removeClass("inactive"),$(e.props.blur).removeClass("active").removeClass("search")},searchOpen:function(){var e=$(".mmx-elements-container").height(),t=$(".mmx-elements-container .mmx-header-section.header-bottom").height(),o=this,n=$(o.props.searchDropdown);o.lazyLoadAssets(n),mmx.trigger(mmx.events.bodyClick),$(o.props.searchContainer).addClass("active"),$(o.props.middleContainer).addClass("inactive"),$(o.props.blur).addClass("active").addClass("search");var i=$(document).height()-(e-t);$(o.props.blur).css("height",i)},init:function(){var e=this;e.ui()}},$(document).ready(function(){mmx.search.init()});var mmx=mmx||{};mmx.storeTime={props:{dropdown:".mmx-hf.mmx-header .store-dropdown",indicator:".mmx-hf.mmx-header .open-indicator",openData:"open-today",closedData:"closed-today",timeOpen:0,timeClosed:0},ui:function(){var e=this;$indicator=$(e.props.indicator),e.updateTime(),$(e.props.dropdown).on("click",function(){e.updateTime()})},updateTime:function(){var e=this,t=new Date,o=100*t.getHours()+t.getMinutes(),n=$(e.props.indicator),i=parseInt(n.data(e.props.openData)),a=parseInt(n.data(e.props.closedData));n.removeClass("closed").removeClass("open"),isNaN(i)&&isNaN(a)||(o<a&&o>i?n.addClass("open"):n.addClass("closed"))},init:function(){var e=this;e.ui()}},$(document).ready(function(){mmx.storeTime.init()});var mmx=mmx||{};mmx.tophat={props:{tophatContainer:".mmx-tophat-container"},toggleTopHat:function(){var e=this,t=window.pageId?window.pageId:null,o=["yourcart"];o.indexOf(t)===-1&&$(e.props.tophatContainer).removeClass("dont-show")},init:function(){var e=this;e.toggleTopHat()}},$(document).ready(function(){mmx.tophat.init()});