<!DOCTYPE html>
<!-- saved from url=(0066)https://cookieatlas.staples.com/cookieatlas/html/server/index.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Document</title>
  </head>
  <body>
  
  <script type="text/javascript" src="./jquery.min.js"></script>
  <script>
var CM = CM || {};CM.Cache=function(){var a=this;CM.storage||(CM.storage={}),a.storage=CM.storage},CM.Cache.prototype.supportsLocalStorage=function(){try{return window.localStorage.foo="bar","bar"===window.localStorage.foo?(delete window.localStorage.foo,!0):!1}catch(a){return!1}},CM.Cache.prototype.read=function(a){var b=this;return b.storage[a]},CM.Cache.prototype.readJSON=function(a){var b=this,c=b.read(a);return c?CM.common.parseJSON(c):c},CM.Cache.prototype.write=function(a,b){var c=this;c.storage[a]=b},CM.Cache.prototype.writeJSON=function(a,b){var c=this;c.write(a,CM.common.toJSON(b))},CM.Cache.prototype.clear=function(a){var b=this;delete b.storage[a]},CM.Client=function(a){var b=this;b.id=CM.GUID.generate(),b.shortId=b.id.split("-")[0],b.queue=[],b.errors=0,b.pending={},b.ready=!1,b.cache=new CM.Cache,b.register(),b.listen(),b.init(a)},CM.Client.prototype.init=function(a){var b=this;if(a){if(!a.length)throw"Invalid argument to constructor: expecting either array of cookie objects or null"}else a=[];for(var c in a){var d=a[c];if(d.value||!d.value&&-1!==document.cookie.indexOf(d.name)){var e=CM.common.readCookie(d.name);d.value=e,b.setSync(d),b.clearSync(d.name,d.domain,d.path)}}CM.common.startedFetching||(CM.common.startedFetching=!0,b.fetch().done(function(a){for(var c in a.cookies){var d;try{var d=CM.common.parseJSON(a.cookies[c])}catch(e){var d={name:c,value:a.cookies[c]}}b.cache.writeJSON(c,d)}CM.common.localStorageReady=!0,$(document).trigger(CM.conf.readyEvent)}))},CM.Client.prototype.register=function(){var a=this,b=$("#"+CM.conf.frameId);if($(b).length>0)a.frame=$(b)[0];else{var c=$("<iframe />",{id:CM.conf.frameId,src:CM.conf.frameSrc,style:"display:none;visibility:hidden",width:0,height:0});$("body").append(c),a.frame=c[0]}a.ping()},CM.Client.prototype.listen=function(){var a=this,b=function(b){b.origin===CM.conf.origin&&a.handle(b)};window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent&&window.attachEvent("onmessage",b)},CM.Client.prototype.handle=function(a){var b=this,c=CM.Message.deserialize(a.data);if(c.clientId==b.id)switch(CM.common.logIncoming("CLIENT",b.id,c.type),c.type){case"ACK":clearInterval(b.pingInterval),b.ready=!0,b.processQueue();break;case"GET":b.resolveGet(c);break;case"SET":b.resolveSet(c);break;case"CLEAR":b.resolveClear(c);break;case"FETCH":b.resolveFetch(c)}},CM.Client.prototype.ping=function(){var a=this;a.pingInterval=setInterval(function(){a.post(new CM.Message(a.id,"PING"))},CM.conf.pingTimeout)},CM.Client.prototype.processQueue=function(){var a=this;if(0==a.queue.length)return void clearInterval(a.clearInterval);var b=a.queue.shift();a.post(b),a.queueInterval||(a.queueInterval=setInterval(function(){a.processQueue()},CM.conf.waitBetweenMessages))},CM.Client.prototype.post=function(a){var b=this;try{b.ready||"PING"===a.type?(b.frame.contentWindow.postMessage(a.serialize(),CM.conf.origin),CM.common.logOutgoing("CLIENT",b.id,a.type)):b.ready||b.queue.push(a)}catch(c){console.error(c)}},CM.Client.prototype.send=function(a,b){var c=this,d=new CM.Message(c.id,a,b),e=$.Deferred();return c.pending[d.id]=e,c.post(d),e.promise()},CM.Client.prototype.resolve=function(a,b){var c=this,d=c.pending[a];d.resolve(b),delete c.pending[a]},CM.Client.prototype.fetch=function(a){var b=this;return b.send("FETCH",{cookies:a})},CM.Client.prototype.resolveFetch=function(a){var b=this;b.resolve(a.id,a.data)},CM.Client.prototype.get=function(a){var b=this;return b.send("GET",{name:a})},CM.Client.prototype.getSync=function(a){var b=this;return b.cache.readJSON(a)},CM.Client.prototype.resolveGet=function(a){var b,c=this;try{b=CM.common.parseJSON(a.data.value)}catch(d){b={value:a.data.value}}c.resolve(a.id,b)},CM.Client.prototype.set=function(a,b,c,d,e,f,g){var h=this,i={};i="object"==typeof a&&1==arguments.length?a:{name:a,value:b,domain:CM.conf.domain,expires:d,path:"/",maxAge:f,secure:g};var j=h.cache.readJSON(i.name);return j!=i&&h.cache.writeJSON(i.name,i),h.send("SET",i)},CM.Client.prototype.setSync=function(a,b,c,d,e,f,g){var h=this,i={};i="object"==typeof a&&1==arguments.length?a:{name:a,value:b,domain:CM.conf.domain,expires:d,path:"/",maxAge:f,secure:g},h.cache.writeJSON(i.name,i),h.set(i)},CM.Client.prototype.resolveSet=function(a){var b=this;b.resolve(a.id)},CM.Client.prototype.clear=function(a,b,c){var d=this;return d.send("CLEAR",{name:a,domain:b,path:c})},CM.Client.prototype.clearSync=function(a,b,c){var d=this;d.cache.clear(a),CM.common.clearCookie(a,b,c),d.clear(a,b,c)},CM.Client.prototype.resolveClear=function(a){var b=this;b.resolve(a.id)},CM.GUID={S4:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},generate:function(){var a=this;return a.S4()+a.S4()+"-"+a.S4()+"-"+a.S4()+"-"+a.S4()+"-"+a.S4()+a.S4()+a.S4()}},CM.Message=function(a,b,c){var d=this;d.id=CM.GUID.generate(),d.clientId=a,d.type=b,d.data=c},CM.Message.prototype.serialize=function(){var a=this;return JSON.stringify(a)},CM.Message.deserialize=function(a){a=JSON.parse(a);var b=new CM.Message(a.clientId,a.type,a.data);return b.id=a.id,b},CM.Server=function(){var a=this;a.id=CM.GUID.generate(),a.shortId=a.id.split("-")[0],a.register()},CM.Server.prototype.register=function(){var a=this,b=function(b){a.handle(b)};window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent&&window.attachEvent("onmessage",b)},CM.Server.prototype.handle=function(a){var b=this,c=CM.Message.deserialize(a.data);switch(CM.common.logIncoming("SERVER",b.id,c.type),c.type){case"PING":b.ack(c,a);break;case"GET":b.get(c,a);break;case"SET":b.set(c,a);break;case"CLEAR":b.clear(c,a);break;case"FETCH":b.fetch(c,a)}},CM.Server.prototype.ack=function(a,b){var c=this;a.type="ACK",c.post(a,b)},CM.Server.prototype.get=function(a,b){var c=this;a.data.value=c.read(a.data.name),c.post(a,b)},CM.Server.prototype.set=function(a,b){var c=this;c.write(a.data),a.data=void 0,c.post(a,b)},CM.Server.prototype.clear=function(a,b){var c=this;CM.common.clearCookie(a.data.name,a.data.domain,a.data.path),a.data=void 0,c.post(a,b)},CM.Server.prototype.fetch=function(a,b){var c=this,d=document.cookie.split("; "),e={};for(var f in d){var g=d[f],h=g.split("=");if(2==h.length){var i=h[0],j=h[1];"undefined"!==j&&(a.data.cookies&&-1==$.inArray(i,a.data.cookies)||(e[i]=j))}}a.data={cookies:e},c.post(a,b)},CM.Server.prototype.post=function(a,b){var c=this;try{b.source.postMessage(a.serialize(),b.origin),CM.common.logOutgoing("SERVER",c.id,a.type)}catch(d){}},CM.Server.prototype.read=function(a){return CM.common.readCookie(a)},CM.Server.prototype.write=function(a){a.domain=CM.conf.domain,a.path="/";var b=CM.common.toJSON(a);return a.value=b,CM.common.writeCookie(a)},CM.common={startedFetching:!1,localStorageReady:!1,logIncoming:function(a,b,c){window.console&&console.debug("<",a,b.split("-")[0],c)},logOutgoing:function(a,b,c){window.console&&console.debug(">",a,b.split("-")[0],c)},debug:function(){window.console&&console.debug.apply(console,arguments)},readCookie:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""},writeCookie:function(a){if(a.path||(a.path="/"),!a.name||/^(?:expires|max\-age|path|domain|secure)$/i.test(a.name))return!1;var b="";if(a.expires)switch(a.expires.constructor){case Number:b=a.expires===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+a.expires;break;case String:b="; expires="+a.expires;break;case Date:b="; expires="+a.expires.toUTCString()}return document.cookie=encodeURIComponent(a.name)+"="+encodeURIComponent(a.value)+b+(a.domain?"; domain="+a.domain:"")+(a.path?"; path="+a.path:"")+(a.secure?"; secure":""),!0},clearCookie:function(a,b,c){var d=this;d.debug("X","DELETING",a);var e="Thu, 01 Jan 1970 00:00:01 GMT",f={name:a,expires:e,domain:b,path:c};console.info(f),CM.common.writeCookie(f),-1==document.cookie.indexOf(a)&&d.debug("X","DELETED",a)},toJSON:function(a){return JSON.stringify(a)},parseJSON:function(a){return JSON.parse(decodeURIComponent(a))}},CM.conf={origin:window.location.protocol+"//cookieatlas.staples.com",domain:"cookieatlas.staples.com",frameId:"cookie-monster-frame",frameSrc:window.location.protocol+"//cookieatlas.staples.com/sbd/cookieatlas/html/server/index.html",pingTimeout:1e3,maxErrors:50,waitBetweenMessages:500,readyEvent:"cookieMonsterReady",domainsToClear:[".staples.com","staples.com","www.staples.com"]};
</script>
  <script type="text/javascript">
    var server = new CM.Server();
  </script>

</body></html>