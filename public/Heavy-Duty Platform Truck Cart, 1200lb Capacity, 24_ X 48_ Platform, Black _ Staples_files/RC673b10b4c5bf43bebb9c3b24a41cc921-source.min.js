// For license information, see `http://assets.adobedtm.com/COdd96606bbf7842eda8ef8bbf91b3bd7c/PR788024d421dd4391a4087977b9a9cf35/BLf046f2deb8b144368360d71561097eab/RC673b10b4c5bf43bebb9c3b24a41cc921-source.js`.
_satellite.__registerScript('//assets.adobedtm.com/COdd96606bbf7842eda8ef8bbf91b3bd7c/PR788024d421dd4391a4087977b9a9cf35/BLf046f2deb8b144368360d71561097eab/RC673b10b4c5bf43bebb9c3b24a41cc921-source.min.js', "window.ae.runPollerOnce(function(){return window.postMessage&&window.$},function(){try{if(window.CM)throw{message:\"cookiemonster already initialized\"};var p=p||{};p.Cache=function(){var e=this;p.storage||(p.storage={}),e.storage=p.storage},p.Cache.prototype.supportsLocalStorage=function(){try{return(window.localStorage.foo=\"bar\")===window.localStorage.foo&&(delete window.localStorage.foo,!0)}catch(e){return!1}},p.Cache.prototype.read=function(e){return this.storage[e]},p.Cache.prototype.readJSON=function(e){var t=this.read(e);return t?p.common.parseJSON(t):t},p.Cache.prototype.write=function(e,t){this.storage[e]=t},p.Cache.prototype.writeJSON=function(e,t){this.write(e,p.common.toJSON(t))},p.Cache.prototype.clear=function(e){delete this.storage[e]},p.Client=function(e){var t=this;t.id=p.GUID.generate(),t.shortId=t.id.split(\"-\")[0],t.queue=[],t.errors=0,t.pending={},t.ready=!1,t.cache=new p.Cache,t.register(),t.listen(),t.init(e)},p.Client.prototype.init=function(e){var r=this;if(e){if(!e.length)throw\"Invalid argument to constructor: expecting either array of cookie objects or null\"}else e=[];for(var t in e){var o=e[t];if(o.value||!o.value&&-1!==document.cookie.indexOf(o.name)){var n=p.common.readCookie(o.name);o.value=n,r.setSync(o),r.clearSync(o.name,o.domain,o.path)}}p.common.startedFetching||(p.common.startedFetching=!0,r.fetch().done(function(e){for(var t in e.cookies){try{var o=p.common.parseJSON(e.cookies[t])}catch(n){o={name:t,value:e.cookies[t]}}r.cache.writeJSON(t,o)}p.common.localStorageReady=!0,$(document).trigger(p.conf.readyEvent)}))},p.Client.prototype.register=function(){var e=this,t=$(\"#\"+p.conf.frameId);if(0<$(t).length)e.frame=$(t)[0];else{var o=$(\"<iframe />\",{id:p.conf.frameId,src:p.conf.frameSrc,style:\"display:none;visibility:hidden\",width:0,height:0});$(\"body\").append(o),e.frame=o[0]}e.ping()},p.Client.prototype.listen=function(){var t=this,e=function(e){e.origin===p.conf.origin&&t.handle(e)};window.addEventListener?window.addEventListener(\"message\",e,!1):window.attachEvent&&window.attachEvent(\"onmessage\",e)},p.Client.prototype.handle=function(e){var t=this,o=p.Message.deserialize(e.data);if(o.clientId==t.id)switch(p.common.logIncoming(\"CLIENT\",t.id,o.type),o.type){case\"ACK\":clearInterval(t.pingInterval),t.ready=!0,t.processQueue();break;case\"GET\":t.resolveGet(o);break;case\"SET\":t.resolveSet(o);break;case\"CLEAR\":t.resolveClear(o);break;case\"FETCH\":t.resolveFetch(o)}},p.Client.prototype.ping=function(){var e=this;e.pingInterval=setInterval(function(){e.post(new p.Message(e.id,\"PING\"))},p.conf.pingTimeout)},p.Client.prototype.processQueue=function(){var e=this;if(0!=e.queue.length){var t=e.queue.shift();e.post(t),e.queueInterval||(e.queueInterval=setInterval(function(){e.processQueue()},p.conf.waitBetweenMessages))}else clearInterval(e.clearInterval)},p.Client.prototype.post=function(e){var t=this;try{t.ready||\"PING\"===e.type?t.frame&&t.frame.contentWindow&&t.frame.contentWindow.postMessage&&(t.frame.contentWindow.postMessage(e.serialize(),p.conf.origin),p.common.logOutgoing(\"CLIENT\",t.id,e.type)):t.ready||t.queue.push(e)}catch(o){window.console&&\"function\"==typeof console.error&&console.error(o)}},p.Client.prototype.send=function(e,t){var o=this,n=new p.Message(o.id,e,t),r=$.Deferred();return o.pending[n.id]=r,o.post(n),r.promise()},p.Client.prototype.resolve=function(e,t){var o=this;o.pending[e].resolve(t),delete o.pending[e]},p.Client.prototype.fetch=function(e){return this.send(\"FETCH\",{cookies:e})},p.Client.prototype.resolveFetch=function(e){this.resolve(e.id,e.data)},p.Client.prototype.get=function(e){return this.send(\"GET\",{name:e})},p.Client.prototype.getSync=function(e){return this.cache.readJSON(e)},p.Client.prototype.resolveGet=function(e){var t,o=this;try{t=p.common.parseJSON(e.data.value)}catch(n){t={value:e.data.value}}o.resolve(e.id,t)},p.Client.prototype.set=function(e,t,o,n,r,i,a){var c=this,s={};return s=\"object\"==typeof e&&1==arguments.length?e:{name:e,value:t,domain:p.conf.domain,expires:n,path:\"/\",maxAge:i,secure:a},c.cache.readJSON(s.name)!=s&&c.cache.writeJSON(s.name,s),c.send(\"SET\",s)},p.Client.prototype.setSync=function(e,t,o,n,r,i,a){var c=this,s={};s=\"object\"==typeof e&&1==arguments.length?e:{name:e,value:t,domain:p.conf.domain,expires:n,path:\"/\",maxAge:i,secure:a},c.cache.writeJSON(s.name,s),c.set(s)},p.Client.prototype.resolveSet=function(e){this.resolve(e.id)},p.Client.prototype.clear=function(e,t,o){return this.send(\"CLEAR\",{name:e,domain:t,path:o})},p.Client.prototype.clearSync=function(e,t,o){var n=this;n.cache.clear(e),p.common.clearCookie(e,t,o),n.clear(e,t,o)},p.Client.prototype.resolveClear=function(e){this.resolve(e.id)},p.GUID={S4:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},generate:function(){var e=this;return e.S4()+e.S4()+\"-\"+e.S4()+\"-\"+e.S4()+\"-\"+e.S4()+\"-\"+e.S4()+e.S4()+e.S4()}},p.Message=function(e,t,o){var n=this;n.id=p.GUID.generate(),n.clientId=e,n.type=t,n.data=o},p.Message.prototype.serialize=function(){var e=this;return JSON.stringify(e)},p.Message.deserialize=function(e){try{e=JSON.parse(e);var t=new p.Message(e.clientId,e.type,e.data);return t.id=e.id,t}catch(o){}},p.Server=function(){var e=this;e.id=p.GUID.generate(),e.shortId=e.id.split(\"-\")[0],e.register()},p.Server.prototype.register=function(){var t=this,e=function(e){t.handle(e)};window.addEventListener?window.addEventListener(\"message\",e,!1):window.attachEvent&&window.attachEvent(\"onmessage\",e)},p.Server.prototype.handle=function(e){var t=this,o=p.Message.deserialize(e.data);switch(p.common.logIncoming(\"SERVER\",t.id,o.type),o.type){case\"PING\":t.ack(o,e);break;case\"GET\":t.get(o,e);break;case\"SET\":t.set(o,e);break;case\"CLEAR\":t.clear(o,e);break;case\"FETCH\":t.fetch(o,e)}},p.Server.prototype.ack=function(e,t){var o=this;e.type=\"ACK\",o.post(e,t)},p.Server.prototype.get=function(e,t){var o=this;e.data.value=o.read(e.data.name),o.post(e,t)},p.Server.prototype.set=function(e,t){var o=this;o.write(e.data),e.data=undefined,o.post(e,t)},p.Server.prototype.clear=function(e,t){var o=this;p.common.clearCookie(e.data.name,e.data.domain,e.data.path),e.data=undefined,o.post(e,t)},p.Server.prototype.fetch=function(e,t){var o=this,n=document.cookie.split(\"; \"),r={};for(var i in n){var a=n[i].split(\"=\");if(2==a.length){var c=a[0],s=a[1];\"undefined\"!==s&&(e.data.cookies&&-1==$.inArray(c,e.data.cookies)||(r[c]=s))}}e.data={cookies:r},o.post(e,t)},p.Server.prototype.post=function(e,t){var o=this;try{t.source.postMessage(e.serialize(),t.origin),p.common.logOutgoing(\"SERVER\",o.id,e.type)}catch(n){}},p.Server.prototype.read=function(e){return p.common.readCookie(e)},p.Server.prototype.write=function(e){e.domain=p.conf.domain,e.path=\"/\";var t=p.common.toJSON(e);return e.value=t,p.common.writeCookie(e)},p.common={startedFetching:!1,localStorageReady:!1,logIncoming:function(){},logOutgoing:function(){},debug:function(){},readCookie:function(e){for(var t=e+\"=\",o=document.cookie.split(\";\"),n=0;n<o.length;n++){for(var r=o[n];\" \"==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return\"\"},writeCookie:function(e){if(e.path||(e.path=\"/\"),!e.name||/^(?:expires|max\\-age|path|domain|secure)$/i.test(e.name))return!1;var t=\"\";if(e.expires)switch(e.expires.constructor){case Number:t=e.expires===Infinity?\"; expires=Fri, 31 Dec 9999 23:59:59 GMT\":\"; max-age=\"+e.expires;break;case String:t=\"; expires=\"+e.expires;break;case Date:t=\"; expires=\"+e.expires.toUTCString()}return document.cookie=encodeURIComponent(e.name)+\"=\"+encodeURIComponent(e.value)+t+(e.domain?\"; domain=\"+e.domain:\"\")+(e.path?\"; path=\"+e.path:\"\")+(e.secure?\"; secure\":\"\"),!0},clearCookie:function(e,t,o){var n=this;n.debug(\"X\",\"DELETING\",e);var r={name:e,expires:\"Thu, 01 Jan 1970 00:00:01 GMT\",domain:t,path:o};p.common.writeCookie(r),-1==document.cookie.indexOf(e)&&n.debug(\"X\",\"DELETED\",e)},toJSON:function(e){return JSON.stringify(e)},parseJSON:function(e){return JSON.parse(decodeURIComponent(e))}},p.conf={origin:window.location.protocol+\"//cookieatlas.staples.com\",domain:\"cookieatlas.staples.com\",frameId:\"cookie-monster-frame\",frameSrc:window.location.protocol+\"//cookieatlas.staples.com/cookieatlas/html/server/index.html\",pingTimeout:1e3,maxErrors:50,waitBetweenMessages:500,readyEvent:\"cookieMonsterReady\",domainsToClear:[\".staples.com\",\"staples.com\",\"www.staples.com\"]},window.CM=p}catch(o){var e=\"ERROR initializing cookieatlas client\",t=e+\": \"+o.message;window.console&&(\"function\"==typeof console.error&&console.error(t)||\"function\"==typeof console.log&&console.log(t))}});");