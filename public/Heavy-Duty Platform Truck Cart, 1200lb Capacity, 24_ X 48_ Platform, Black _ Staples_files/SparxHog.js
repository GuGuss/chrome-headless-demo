function checkUserToken(){var a=getCookie("EDDIE_CUSTOMER_TOKEN");null==a||""==a?$.ajax({type:"GET",url:"/asgard-node/v1/nad/staplesus/sparx/session/get",success:function(a){if(a){if($("body").append('<input type="hidden" id="sparxToken" />'),document.getElementById("sparxToken").value=a.reply["hog-session-token"],"undefined"!=typeof Storage)try{window.sessionStorage.EDDIE_CUSTOMER_TOKEN=a.reply["hog-session-token"]}catch(b){window.console&&void 0}$("body").trigger("callMarvin","success")}},error:function(a,b,c){window.console&&void 0,$("body").append('<input type="hidden" id="sparxToken" />'),$("body").trigger("callMarvin","error")}}):"undefined"==typeof Storage||window.sessionStorage.EDDIE_CUSTOMER_TOKEN?($("body").append('<input type="hidden" id="sparxToken" />'),document.getElementById("sparxToken").value=a,$("body").trigger("callMarvin","success")):ensureSession(),setInterval(function(){ensureSession()},36e5)}function getCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""}function deleteCookie(a){document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function ensureSession(){var a=$("#sparxToken"),b=getCookie("EDDIE_CUSTOMER_TOKEN");b&&(a.length||$("body").append('<input type="hidden" id="sparxToken" />'),$.ajax({type:"GET",url:"/asgard-node/v1/nad/staplesus/sparx/session/ensure",success:function(a){if(document.getElementById("sparxToken").value=a.reply["hog-session-token"],"undefined"==typeof Storage||window.sessionStorage.EDDIE_CUSTOMER_TOKEN||$("body").trigger("callMarvin","success"),"undefined"!=typeof Storage)try{window.sessionStorage.EDDIE_CUSTOMER_TOKEN=a.reply["hog-session-token"]}catch(b){window.console&&void 0}},error:function(a,b,c){deleteCookie("EDDIE_CUSTOMER_TOKEN"),"undefined"==typeof Storage||window.sessionStorage.EDDIE_CUSTOMER_TOKEN||$("body").trigger("callMarvin","error"),window.console&&void 0}}))}function getRecentlyViewed(){var a=$("#sparxToken"),b="/asgard-node/v1/nad/staplesus/recommendations/html?theme=ux2&scheme=RECENTLY_VIEWED&marvinVersion=2&engine=SPARX",c=function(b){var c=a.val()||"";b=b+"&EDDIE_CUSTOMER_TOKEN="+c;var d=$("meta[name=PageName]").attr("content")||"";"dailydeals"===d&&-1!=$("link[rel=canonical]").attr("href").indexOf("cat_CG")?d="category":"dailydeals"===d&&-1!=$("link[rel=canonical]").attr("href").indexOf("cat_SC")?d="superCategory":"searchresults"===d&&"NoResultsPage"===$("#pageName").val()&&(d="nosearchresults"),b=b+"&pageType="+d,"home"===d&&-1!=$("link[rel=canonical]").attr("href").indexOf("com")&&(b=b+"&sclinktype="+!0),STAPLES.ANALYTICS&&STAPLES.ANALYTICS.signalContentloading(),$.ajax({method:"get",url:b,dataType:"text",success:function(a){if(a&&(text=$.trim(a),text.length>0)){$("#recentlyViewedList").html(text),stp.productTiles.validateAirMilesRewards("#recentlyViewedList");var b=$("#recentlyViewedList .stp--new-product-tile-container").first().attr("data-dynamic-title");b?$("#recentlyViewedTitle").text(b):b=$("#recentlyViewedTitle").text(),1==$("#homepage").length&&$("#recentlyViewedSection").addClass("pers-carousel-center");b.replace(/\s+/g,"").toLowerCase();$("#recentlyViewedSection").show(),stp.carousels.init(),$("#recentlyViewedList").find(".scTrack").each(function(){$(this).attr("locater","recentlyViewed")}),"home"===d&&-1!=$("link[rel=canonical]").attr("href").indexOf("com")&&loadGlobalLocator("recentlyViewed","Recommendations",b,"","",b,b+" Carousel"),$("#recentlyViewedList").find(".analyticsProductTileData").each(function(a){"function"==typeof loadGlobalItemWithHtml?loadGlobalItemWithHtml("recentlyViewed",$(this).attr("content")):"object"==typeof certonaAnalytics&&"function"==typeof certonaAnalytics.loadGlobalItemWithHtml?certonaAnalytics.loadGlobalItemWithHtml("recentlyViewed",$(this).attr("content")):"object"==typeof STAPLES.Personalization&&"function"==typeof STAPLES.Personalization.loadGlobalItemWithHtml&&STAPLES.Personalization.loadGlobalItemWithHtml(a,"recentlyViewed",$(this).attr("content"),"SPARX")}),stp.productTiles.setupEndcapProducts()}STAPLES.ANALYTICS&&(STAPLES.ANALYTICS.signalContentLoaded(),"undefined"!=typeof analyticsCallForDailyDeals&&analyticsCallForDailyDeals&&(analyticsCallForDailyDeals--,0==analyticsCallForDailyDeals&&STAPLES.ANALYTICS.signalContentLoaded()))},error:function(a){STAPLES.ANALYTICS&&(STAPLES.ANALYTICS.signalContentLoaded(),"undefined"!=typeof analyticsCallForDailyDeals&&analyticsCallForDailyDeals&&(analyticsCallForDailyDeals--,0==analyticsCallForDailyDeals&&STAPLES.ANALYTICS.signalContentLoaded()))}})},d=$("#printableOrdSummary").length,e=$("#carouselFirstSection").length,f=$("#tech-bundle-page").length,g=$("meta[name=PageName]").attr("content")||"",h=window.location.pathname.indexOf("sbd/cre"),i=window.location.pathname.indexOf("sbd/content"),j=$("#externalAssetPrefixOverlay").data("externalAsset")||"";-1==h&&-1==i&&""!==j&&$.ajax({url:j+"/js/overlayBundle.js",dataType:"script",async:!0,cache:!0,success:function(){},error:function(){}}),a.length&&$("#sparxToken").val()&&0==d&&"rewardsplus"!==g&&0==e&&0==f&&-1==h&&-1==i&&c(b),$("body").on("callMarvin",function(a,j){"error"!==j&&0==d&&"rewardsplus"!==g&&0==e&&0==f&&-1==h&&-1==i&&c(b)})}checkUserToken(),"personalinfo"!==window.pageId&&getRecentlyViewed();
//# sourceMappingURL=SparxHog.map